services:
  thermocycling:
    build: .
    container_name: thermocycling
    ports:
      - "5050:5050"   # MLflow UI (inside container)
    volumes:
      - ./data:/app/data
      - ./configs:/app/configs
      - ./mlruns:/app/mlruns
      - ./mlflow.db:/app/mlflow.db
      - ./optuna_studies.db:/app/optuna_studies.db
      - ./results:/app/results
    environment:
      - MLFLOW_HOST=0.0.0.0
      - MLFLOW_PORT=5050
      # Optional fallbacks if you omit them from YAML
      - MLFLOW_TRACKING_URI=sqlite:///mlflow.db
      - OPTUNA_STORAGE=sqlite:///optuna_studies.db
    # Override this per run if needed:
    # command: ["python", "scripts/run_optimization_from_config.py", "configs/config_lstm_regression.yaml"]